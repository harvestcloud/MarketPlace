{% extends 'HarvestCloudMarketPlaceSellerBundle::layout.html.twig' %}

{% block content %}
    <h1>Open Orders</h1>

    <table>
        <thead>
            <tr>
                <th>Number</th>
                <th>Buyer</th>
                <th>Seller</th>
                <th>Hub</th>
                <th>Sum of Line Items</th>
                <th colspan="2">Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
                <tr>
                  <td>{{ order.id }}</td>
                  <td>{{ order.buyer.name }}</td>
                  <td>{{ order.seller.name }}</td>
                  <td>
                      {%  if order.hub %}
                          {{ order.hub.name }}
                      {% else %}
                          <em>Unknown</em>
                      {% endif %}
                  </td>
                  <td>{{ order.sumOfLineItems|number_format(2) }}</td>
                  <td>
                    {% if order.isOpen %}
                      Open
                    {% endif %}
                  </td>
                  <td>{{ order.status }}</td>
                  <td class="actions">
                      {% if order.canBeAcceptedBySeller %}
                          <form action="{{ path('Seller_order_accept', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Accept" />
                          </form>
                      {% endif %}
                      {% if order.canBeRejectedBySeller %}
                          <form action="{{ path('Seller_order_reject', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Reject" />
                          </form>
                      {% endif %}
                      {% if order.canBePickedBySeller %}
                          <form action="{{ path('Seller_order_pick', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Pick" />
                          </form>
                      {% endif %}
                      {% if order.canBeMarkedReadyForDispatchedBySeller %}
                          <form action="{{ path('Seller_order_mark_ready_for_dispatch', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Ready for dispatch" />
                          </form>
                      {% endif %}
                      {% if order.canBeDispatchedBySeller %}
                          <form action="{{ path('Seller_order_dispatch', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Dispatch" />
                          </form>
                      {% endif %}
                      {% if order.canBeCanceledByBuyer %}
                          <form action="{{ path('Buyer_order_cancel', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Cancel" />
                          </form>
                      {% endif %}
                      {% if order.canBeReceivedByHub %}
                          <form action="{{ path('Hub_order_receive', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Receive" />
                          </form>
                      {% endif %}
                      {% if order.canBeMarkedReadyToBePickedUpFromHub %}
                          <form action="{{ path('Hub_order_mark_as_ready_to_pickup', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Ready to pick up" />
                          </form>
                      {% endif %}
                      {% if order.canBeReleasedByHub %}
                          <form action="{{ path('Hub_order_release', { 'id': order.id }) }}" method="post">
                              <input type="submit" class="submit" value="Release" />
                          </form>
                      {% endif %}
                      <span class="clear"></span>
                  </td><!-- .actions -->
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
